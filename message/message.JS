const chatInput = document.getElementById('chat-input');
const sendBtn = document.getElementById('send-btn');
const chatMessages = document.getElementById('chat-messages');
const promptAside = document.getElementById('prompt-aside');

// 1. ë©”ì‹œì§€ ì „ì†¡ ê¸°ëŠ¥ (ìš°ì¸¡ ì •ë ¬ + ì²´í¬ë°•ìŠ¤)
function sendMessage(content, type = 'text') {
    const text = type === 'text' ? chatInput.value.trim() : `ğŸ“„ íŒŒì¼: ${content}`;
    if (text !== "") {
        const msgId = Date.now();
        const messageDiv = document.createElement('div');
        messageDiv.className = 'message right'; // ìš°ì¸¡ ì •ë ¬ í´ë˜ìŠ¤ ì ìš©
        
        messageDiv.innerHTML = `
            <div class="bubble">${text}</div>
            <div class="profile-group">
                <div class="avatar"></div>
                <input type="checkbox" id="check-${msgId}" class="custom-checkbox">
            </div>
        `;
        
        chatMessages.appendChild(messageDiv);
        if(type === 'text') chatInput.value = "";
        chatMessages.scrollTop = chatMessages.scrollHeight;
    }
}

// 2. íŒŒì¼ íƒìƒ‰ê¸°ì—ì„œ íŒŒì¼ ì„ íƒ ì‹œ ì²˜ë¦¬
function handleFileSelect(input) {
    const file = input.files[0];
    if (file) {
        sendMessage(file.name, 'file');
        input.value = ''; // ì´ˆê¸°í™”
    }
}

// 3. íŒ¨ë„ ì œì–´
function openPrompt() { promptAside.classList.add('active'); }
function closePrompt() { promptAside.classList.remove('active'); }

// ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
sendBtn.addEventListener('click', () => sendMessage());
chatInput.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') sendMessage();
});